import e,{useState as t,createContext as n,useRef as r,useEffect as o,useCallback as a}from"react";import i from"prop-types";import{ReactEditor as l,useEditor as c}from"slate-react";import{Editor as u,Transforms as s,Node as p,Path as d,Point as f}from"slate";import{MarkdownEditor as m}from"@accordproject/ui-markdown-editor";import h from"styled-components";import{Decorators as v}from"@accordproject/markdown-cicero";import{isEqual as g}from"lodash";import{v4 as y}from"uuid";import{HistoryEditor as b}from"slate-history";import{SlateTransformer as x}from"@accordproject/markdown-slate";import{HtmlTransformer as E}from"@accordproject/markdown-html";function C(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function w(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}var O=w((function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.default=e.exports,e.exports.__esModule=!0}));C(O);var F=w((function(e){e.exports=function(e){if(Array.isArray(e))return O(e)},e.exports.default=e.exports,e.exports.__esModule=!0}));C(F);var T=w((function(e){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.default=e.exports,e.exports.__esModule=!0}));C(T);var j=w((function(e){e.exports=function(e,t){if(e){if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0}));C(j);var S=w((function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0}));C(S);var k=C(w((function(e){e.exports=function(e){return F(e)||T(e)||j(e)||S()},e.exports.default=e.exports,e.exports.__esModule=!0}))),N=C(w((function(e){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.default=e.exports,e.exports.__esModule=!0}))),L=w((function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.default=e.exports,e.exports.__esModule=!0}));C(L);var P=w((function(e){e.exports=function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var r,o,a=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);i=!0);}catch(e){l=!0,o=e}finally{try{i||null==n.return||n.return()}finally{if(l)throw o}}return a}},e.exports.default=e.exports,e.exports.__esModule=!0}));C(P);var _=w((function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0}));C(_);var I=C(w((function(e){e.exports=function(e,t){return L(e)||P(e,t)||j(e,t)||_()},e.exports.default=e.exports,e.exports.__esModule=!0}))),D=C(w((function(e){function t(){return e.exports=t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.exports.default=e.exports,e.exports.__esModule=!0,t.apply(this,arguments)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}))),A=C(w((function(e){e.exports=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))},e.exports.default=e.exports,e.exports.__esModule=!0})));function M(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}var H,R,B,U,z,W,q,G,V,Z,J,$,K,Y,Q,X,ee,te,ne;M("@font-face {\n    font-family: 'Graphik';\n    src: url('../../assets/fonts/Graphik-400.woff'),\n         url('../../assets/fonts/Graphik-400.woff2');\n  }\n  \n@font-face {\nfont-family: 'Graphik';\nsrc: url('../../assets/fonts/Graphik-600.woff'),\n     url('../../assets/fonts/Graphik-600.woff2');\nfont-weight: bold;\n}");var re,oe=h.div(H||(H=A(["\n  position: relative;\n  margin: 10px -10px;\n  display: grid;\n  background-color: #F4F6FC;\n  border: ",';\n  border-radius: 3px;\n  grid-template-columns: 10px 375px 1fr 25px 25px 25px 10px;\n  grid-template-rows: 0px 10px 1fr;\n  grid-template-areas: "one two three four five six seven"\n                       "eight nine ten eleven twelve thirteen fourteen"\n                       "fifteen sixteen seventeen eighteen nineteen twenty twentyone";\n'])),(function(e){return e.error?"1px solid #FF0000":"1px solid #19C6C7"})),ae=(h.svg(R||(R=A(["\n  visibility: ",";\n"])),(function(e){return e.currentHover?"visible":"hidden"})),h.svg(B||(B=A(["\n  visibility: ",";\n"])),(function(e){return e.currentHover?"visible":"hidden"}))),ie=h.span(U||(U=A(["\n  visibility: ",";\n  margin-top: -","em;\n\n  &:before {\n    content: '';\n    position: absolute;\n    top: ","px;\n    left: ","px;\n    border-top: 5px solid #141F3C;\n    border-left: 5px solid transparent;\n    border-right: 5px solid transparent;\n  }\n\n  &:after {\n    content: '';\n    position: absolute;\n    top: ","px;\n    left: ","px;\n    border-top: 4px solid #141F3C;\n    border-left: 4px solid transparent;\n    border-right: 4px solid transparent;\n  }\n"])),(function(e){return e.currentHover?"visible":"hidden"}),(function(e){return e.tooltipHeight}),(function(e){return e.caretTop}),(function(e){return e.caretLeft-1}),(function(e){return e.caretTop}),(function(e){return e.caretLeft})),le=h.svg(z||(z=A(["\n  visibility: ",";\n"])),(function(e){return e.currentHover?"visible":"hidden"})),ce=h.span(W||(W=A(["\n  visibility: ",";\n  margin-top: -","em;\n\n  &:before {\n    content: '';\n    position: absolute;\n    top: ","px;\n    left: ","px;\n    border-top: 5px solid #141F3C;\n    border-left: 5px solid transparent;\n    border-right: 5px solid transparent;\n  }\n\n  &:after {\n    content: '';\n    position: absolute;\n    top: ","px;\n    left: ","px;\n    border-top: 4px solid #141F3C;\n    border-left: 4px solid transparent;\n    border-right: 4px solid transparent;\n  }\n"])),(function(e){return e.currentHover?"visible":"hidden"}),(function(e){return e.tooltipHeight}),(function(e){return e.caretTop}),(function(e){return e.caretLeft-1}),(function(e){return e.caretTop}),(function(e){return e.caretLeft})),ue=h.div(q||(q=A(["\n  visibility: ",";\n  font-family: serif;\n  grid-area: two / two / ten / ten;\n  transition-duration: 0.5s;\n  background: linear-gradient(180deg, #FFFFFF 0%, #F4F6FC 100%);\n  align-self: center;\n  justify-self: start;\n  margin-bottom: 9px;\n  padding: 3px;\n  color: #696969;\n  line-height: 14px;\n  font-size: 0.87em;\n  font-weight: 600;\n"])),(function(e){return e.currentHover?"visible":"hidden"})),se=h.div(G||(G=A(["\n  li {\n    transition: none;\n  }\n  font-family: serif;\n  grid-area: sixteen / sixteen / twenty / twenty;\n  margin: 2px 0 10px;\n  color: #141F3C;\n  font-size: 1em;\n  line-height: 22px;\n"]))),pe=h.svg(V||(V=A(["\n  position: relative;\n  z-index: 1;\n  cursor: pointer;\n  fill: ",";\n"])),(function(e){return e.hovering?e.clauseIconColor||"#19C6C7":"#696969"})),de=h(pe)(Z||(Z=A(["\n  fill: #949CA2;\n  position: relative;\n  top: ","px;\n  &:hover {\n    fill: #414F58;\n  }\n"])),(function(e){var t;return null!==(t=e.position)&&void 0!==t?t:-6})),fe=h.div(J||(J=A(["\n  visibility: ",";\n  background: linear-gradient(180deg, #FFF 0%, #F4F6FC 100%);\n  position: relative;\n  z-index: 1;\n  margin-bottom: 9px;\n  padding: 4px;\n  place-self: center;\n  transition-duration: 0.5s;\n  cursor: pointer;\n"])),(function(e){return e.currentHover?"visible":"hidden"})),me=h(fe)($||($=A(["\n  grid-area: four / four / eleven / eleven;\n"]))),he=h(fe)(K||(K=A(["\n  grid-area: five / five / twelve / twelve;\n"]))),ve=h(fe)(Y||(Y=A(["\n  grid-area: six / six / thirteen / thirteen;\n"]))),ge=h(fe)(Q||(Q=A(["\n  grid-area: fifteen;\n  background: linear-gradient(to right, #FFF 0%, #F4F6FC 100%);\n  margin-right: 9px;\n  margin-bottom: 0px;\n  position: relative;\n  top: -5px;\n  max-height: 50px;\n  padding: 4px 0 0 0;\n  cursor: text;\n"]))),ye=(h.svg(X||(X=A(["\n  fill: #46608E;\n  cursor: pointer;\n  grid-area: editIcon;\n  place-self: center;\n\n  &:hover {\n    fill: #FFFFFF;\n  }\n"]))),h.div(ee||(ee=A(["\n  position: absolute;\n  top: -40px;\n  z-index: 99;\n"])))),be=h.div.attrs({contentEditable:"false",suppressContentEditableWarning:"true"})(te||(te=A(["\n  background-color: #121212;\n  padding: 10px;\n  border-radius: 3px;\n  color: #f0f0f0;\n  z-index: 99;\n  font-family: 'IBM Plex Sans', 'sans-serif';\n  transition: all 0.3s ease;\n  :after {\n    content: \" \";\n    display: block;\n    width: 0;\n    height: 0;\n    z-index: 99;\n    position: absolute;\n    top: 100%;\n    left: 5px;\n    border-radius: 0px;\n    border-width: 6px;\n    border-style: solid;\n    border-color: #121212 transparent transparent transparent;\n  }\n"]))),xe=h.span(ne||(ne=A(["\n"]))),Ee=function(){return"trash"},Ce=function(){return"edit"},we=function(){return"test"},Oe=function(){return"drag"},Fe=function(){return"move-up"},Te=function(){return"move-down"},je=function(e){return function(e){return e.toUpperCase()}(function(e){return e.replace(/-/g," ")}(function(e){return e.slice(function(e){return e.lastIndexOf("/")}(e)+1,function(e){return e.indexOf("@")}(e))}(e)))},Se=function(e){return e.reduce((function(e,t){return"".concat(e).concat(t.text)}),"")},ke=n(null),Ne=e.forwardRef((function(n,r){var o=n.clauseProps||Object.create(null),a=t(!1),i=I(a,2),c=i[0],p=(i[1],t(!1)),d=I(p,2),f=d[0],m=d[1],h=t(!1),v=I(h,2),g=v[0],y=v[1],b=t(!1),x=I(b,2),E=x[0],C=x[1],w=t(!1),O=I(w,2),F=O[0],T=O[1],j=je(n.templateUri),S=function(e,t){var n=je(e),r=t?n+t:n;return r.length>54?"".concat(r.slice(0,54),"..."):r}(n.templateUri,o.HEADER_TITLE),k={currentHover:c,contentEditable:!1,suppressContentEditableWarning:!0,style:{userSelect:"none"}},N={"aria-label":we,width:"19px",height:"19px",viewBox:"0 0 16 20",clauseIconColor:o.ICON_HOVER_COLOR},L={"aria-label":Ce,width:"19px",height:"19px",viewBox:"0 0 19 19",clauseIconColor:o.ICON_HOVER_COLOR},P={"aria-label":Ee,width:"19px",height:"19px",viewBox:"0 0 12 15",clauseIconColor:o.ICON_HOVER_COLOR},_={"aria-label":Oe,width:"12px",height:"15px",viewBox:"0 0 12 15"},A={"aria-label":Fe,width:"16px",height:"12px",viewBox:"0 0 16 12"},M={"aria-label":Te,width:"16px",height:"12px",viewBox:"0 0 16 12"},H=function(e,t){var r=l.toSlateNode(n.editor,e.target),o=l.findPath(n.editor,r),a=u.range(n.editor,o),i=u.end(n.editor,[]),c=[Math.max(a.anchor.path[0],a.focus.path[0])+(t?1:-1)];c[0]>=0&&c[0]<=i.path[0]&&s.moveNodes(n.editor,{at:o,to:c})};return e.createElement(ke.Provider,{value:c},e.createElement(oe,D({src:n.templateUri,id:n.name,className:"ui-contract-editor__clause ".concat(n.error?"error":""),style:{userSelect:"".concat(n.readOnly?"text":"none"),padding:"3px"},draggable:"false",ref:r,error:n.error},n.attributes),e.createElement(ue,{className:"ui-contract-editor__clause-header",currentHover:c,contentEditable:!1,suppressContentEditableWarning:!0,style:{userSelect:"none"}},f&&S.length>54&&e.createElement(ye,null,e.createElement(be,null,j+o.HEADER_TITLE)),e.createElement(xe,{onMouseEnter:function(){return m(!0)},onMouseLeave:function(){return m(!1)}},S)),n.readOnly||0===S.length?null:e.createElement(e.Fragment,null,e.createElement(ge,k,e.createElement(de,D({},A,{position:-3,onClick:H}),e.createElement("g",{id:"Side-nav-+-new-editor",stroke:"none",strokeWidth:"1",fillRule:"evenodd"},e.createElement("g",{id:"Drag-and-drop",transform:"translate(-300.000000, -442.000000)"},e.createElement("g",{id:"move_up",transform:"translate(297.000000, 437.000000)"},e.createElement("g",{id:"Icon-24px"},e.createElement("polygon",{id:"Shape",fillRule:"nonzero",points:"4.41 12.41 9 7.83 13.59 12.41 15 11 9 5 3 11"}),e.createElement("polygon",{id:"Shape",points:"0 0 18 0 18 18 0 18",fill:"none"})))))),e.createElement(de,_,e.createElement("g",{id:"Side-nav-+-new-editor",stroke:"none",strokeWidth:"1",fillRule:"evenodd"},e.createElement("g",{id:"Drag-and-drop",transform:"translate(-300.250000, -457.000000)"},e.createElement("g",{id:"handle",transform:"translate(297.000000, 455.000000)"},e.createElement("rect",{id:"Rectangle",x:"0",y:"0",width:"18",height:"22",fill:"none"}),e.createElement("g",{id:"Group-5",transform:"translate(5.000000, 2.000000)",fillRule:"nonzero"},e.createElement("circle",{id:"Oval",cx:"1.5",cy:"1.5",r:"1.5"}),e.createElement("circle",{id:"Oval-Copy-2",cx:"1.5",cy:"6.5",r:"1.5"}),e.createElement("circle",{id:"Oval-Copy",cx:"6.5",cy:"1.5",r:"1.5"}),e.createElement("circle",{id:"Oval-Copy-3",cx:"6.5",cy:"6.5",r:"1.5"}),e.createElement("circle",{id:"Oval-Copy-5",cx:"1.5",cy:"11.5",r:"1.5"}),e.createElement("circle",{id:"Oval-Copy-6",cx:"1.5",cy:"16.5",r:"1.5"}),e.createElement("circle",{id:"Oval-Copy-4",cx:"6.5",cy:"11.5",r:"1.5"}),e.createElement("circle",{id:"Oval-Copy-7",cx:"6.5",cy:"16.5",r:"1.5"})))))),e.createElement(de,D({},M,{position:-10,onClick:function(e){return H(e,!0)}}),e.createElement("g",{id:"Side-nav-+-new-editor",stroke:"none",strokeWidth:"1",fillRule:"evenodd"},e.createElement("g",{id:"Drag-and-drop",transform:"translate(-300.000000, -481.000000)"},e.createElement("g",{id:"move_down",transform:"translate(297.000000, 477.000000)"},e.createElement("g",{id:"Icon-24px"}),e.createElement("polygon",{id:"Shape",fillRule:"nonzero",points:"4.41 4.84 9 9.42 13.59 4.84 15 6.25 9 12.25 3 6.25"}),e.createElement("polygon",{id:"Shape",points:"0 0 18 0 18 18 0 18",fill:"none"})))))),e.createElement(me,D({},k,{onMouseEnter:function(){return y(!0)},onMouseLeave:function(){return y(!1)},onClick:function(){return o.CLAUSE_TEST_FUNCTION(n)}}),e.createElement(pe,D({},N,{hovering:g}),e.createElement("g",{id:"Side-nav-+-new-editor",stroke:"none",strokeWidth:"1",fillRule:"evenodd"},e.createElement("g",{id:"Lab-Flask-Experiment-2-Copy",fillRule:"nonzero"},e.createElement("path",{d:"M15.0833265,16.0833269 L11.4166613,10 C11.333328,9.8333294 11.333328,9.6666628 11.333328,9.5833295 L11.333328,2.0833325 C11.333328,1.8333326 11.4999946,1.666666 11.7499945,1.666666 L12.999994,1.666666 C13.4999938,1.666666 13.833327,1.3333328 13.833327,0.833333 C13.833327,0.3333332 13.4999938,0 12.999994,0 L2.999998,0 C2.4999982,0 2.166665,0.3333332 2.166665,0.833333 C2.166665,1.3333328 2.4999982,1.666666 2.999998,1.666666 L4.2499975,1.666666 C4.4999974,1.666666 4.666664,1.8333326 4.666664,2.0833325 L4.666664,9.5833295 C4.666664,9.7499961 4.666664,9.9166627 4.5833307,10 L0.9999988,16.0833269 C0.2499991,17.2499931 0.499999,18.7499925 1.5833319,19.5833255 C1.9999984,19.8333254 2.4999982,20 2.999998,20 L12.999994,20 C14.4166601,20 15.499993,18.8333258 15.499993,17.5 C15.499993,17 15.3333264,16.5 15.0833265,16.0833269 Z M5.2499971,13.333328 C4.9999972,13.333328 4.8333306,13.166666 4.8333306,12.9166615 C4.8333306,12.8333282 4.8333306,12.7499949 4.9166639,12.666666 L6.2499967,10.4166625 C6.3333306,10.3333292 6.3333306,10.166666 6.3333306,9.999996 L6.3333306,2.0833325 C6.3333306,1.8333326 6.4999966,1.666666 6.7499965,1.666666 L9.2499955,1.666666 C9.4999954,1.666666 9.666662,1.8333326 9.666662,2.0833325 L9.666662,9.999996 C9.666662,10.166666 9.666662,10.3333292 9.7499953,10.4166625 L11.0833281,12.666666 C11.1666614,12.8333282 11.1666614,13.0833281 10.9166615,13.2499947 C10.8333306,13.2499947 10.7499949,13.333328 10.6666616,13.333328 L5.2499971,13.333328 L5.2499971,13.333328 Z",id:"Shape"})))),g&&e.createElement(ye,null,e.createElement(be,null,"Test"))),e.createElement(he,D({},k,{onMouseEnter:function(){return C(!0)},onMouseLeave:function(){return C(!1)},onClick:function(){return o.CLAUSE_EDIT_FUNCTION(n)}}),e.createElement(pe,D({},L,{hovering:E}),e.createElement("g",{id:"Side-nav-+-new-editor",stroke:"none",strokeWidth:"1",fillRule:"evenodd"},e.createElement("path",{d:"M0.0346241458,14.256492 L0,18.1690205 C0,18.3767654 0.0692482916,18.6191344 0.242369021,18.757631 C0.415489749,18.8961276 0.623234624,19 0.830979499,19 L4.74350797,18.9653759 C4.95125285,18.9653759 5.15899772,18.8615034 5.33211845,18.7230068 L18.766287,5.28883827 C19.0779043,4.97722096 19.0779043,4.42323462 18.766287,4.11161731 L14.8883827,0.233712984 C14.5767654,-0.077904328 14.022779,-0.077904328 13.7111617,0.233712984 L11.0104784,2.93439636 L0.276993166,13.6678815 C0.103872437,13.8410023 0.0346241458,14.0487472 0.0346241458,14.256492 Z M17.0004556,4.70022779 L15.4769932,6.22369021 L12.7763098,3.52300683 L14.2997722,1.99954442 L17.0004556,4.70022779 L17.0004556,4.70022779 Z M1.69658314,14.6027335 L11.5990888,4.70022779 L14.2997722,7.40091116 L4.39726651,17.3034169 L1.69658314,17.3034169 L1.69658314,14.6027335 Z",id:"Shape-Copy",fillRule:"nonzero"}))),E&&e.createElement(ye,null,e.createElement(be,null,"Edit"))),e.createElement(ve,D({},k,{onMouseEnter:function(){return T(!0)},onMouseLeave:function(){return T(!1)},onClick:function(){return o.CLAUSE_DELETE_FUNCTION(n)}}),e.createElement(pe,D({},P,{hovering:F}),e.createElement("g",{stroke:"none",strokeWidth:"1",fillRule:"evenodd"},e.createElement("g",{transform:"translate(-222.000000, -602.000000)",fillRule:"nonzero"},e.createElement("path",{d:"M233.913531,604.599251 C234.037294,605.044944 234.082298,605 233.669757,604.996255 L222.328624,604.996255 C221.916083,604.996255 221.964838,605.044944 222.08485,604.599251 C222.178609,604.265918 222.223614,604.11236 222.223614,604.11236 C222.321123,603.764045 222.583649,603.730337 222.947436,603.670412 L224.942635,603.419476 C225.19016,603.374532 225.19016,603.374532 225.28767,603.164794 C225.613952,602.426966 225.711462,602 226.067748,602 L229.930633,602 C230.286919,602 230.388179,602.426966 230.714462,603.161049 C230.811971,603.374532 230.811971,603.374532 231.059496,603.41573 L233.050945,603.666667 C233.418482,603.726592 233.666007,603.726592 233.763516,604.074906 C233.763516,604.074906 233.823522,604.262172 233.913531,604.599251 Z M232.684263,606.808989 C233.306825,606.808989 233.336828,606.88764 233.299324,607.359551 L232.598004,616.445693 C232.537998,616.906367 232.492993,617 231.941688,617 L224.170912,617 C223.619607,617 223.574603,616.906367 223.514597,616.445693 L222.813277,607.359551 C222.775773,606.891386 222.805776,606.808989 223.428338,606.808989 L232.684263,606.808989 Z"})))),F&&e.createElement(ye,null,e.createElement(be,null,"Delete")))),e.createElement(se,null,n.children)))}));Ne.displayName="ClauseComponent",Ne.propTypes={attributes:i.PropTypes.shape({"data-key":i.string}),children:i.PropTypes.object.isRequired,name:i.string,clauseProps:i.shape({CLAUSE_DELETE_FUNCTION:i.func,CLAUSE_EDIT_FUNCTION:i.func,CLAUSE_TEST_FUNCTION:i.func}),editor:i.any,error:i.bool,readOnly:i.bool,templateUri:i.string.isRequired};var Le,Pe="clause",_e="variable",Ie=(N(re={},_e,!0),N(re,"conditional",!0),N(re,"optional",!0),N(re,"formula",!0),re),De={},Ae=function(e){var t=e.isVoid,n=e.isInline;return e.isVoid=function(e){return De[e.type]||t(e)},e.isInline=function(e){return Ie[e.type]||n(e)},e},Me=function(e){var t=e.selection;return!!t&&(!!g(t.anchor.path,t.focus.path)&&p.parent(e,e.selection.focus.path).type===_e)},He=function(e){try{return!0===new v(e.data).getDecoratorValue("ContractEditor","readOnly")}catch(e){return!1}};function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ue=function(e,t,n,r){void 0!==e[t]&&(n[r||t]=e[t])},ze=h.span(Le||(Le=A(["\n  border: "," 1px solid !important;\n  background-color: "," !important;\n  opacity: "," !important;\n  ","\n  "])),(function(e){return e.border}),(function(e){return e["background-color"]}),(function(e){return e.opacity}),(function(e){return e["font-family"]?"font-family:".concat(e["font-family"],"!important;"):""})),We=e.forwardRef((function(t,n){var r=t.attributes,o=t.children,a=t.editor,i=t.element,l=t.isFormulaDependency,c=function(e){try{return new v(e.data).getArguments("ContractEditor")}catch(e){return{}}}(i),u={};u.border="#A4BBE7",u["background-color"]="#FFFFFF",u.border="#A4BBE7",u.opacity=1,l(a,i)&&(u.border="#AF54C4",u["background-color"]="#BED3FC",u.border="#A4BBE7"),c&&(Ue(c,"border",u),Ue(c,"backgroundColor",u,"background-color"),Ue(c,"opacity",u),Ue(c,"fontFamily",u,"font-family"));var s=Be(Be(Be({className:_e,name:i.data.name},r),u),{},{ref:n});return e.createElement(ze,s,o)}));We.displayName="Variable",We.propTypes={attributes:i.PropTypes.shape({"data-key":i.string}),children:i.object.isRequired,editor:i.any,element:i.any,isFormulaDependency:i.func};var qe=function(){return"addConditional"},Ge=function(t){return e.createElement("g",{id:"Page-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},e.createElement("g",{id:"conditional-icon-default",transform:"translate(2.000000, 1.000000)",fillRule:"nonzero"},e.createElement("g",{id:"Oval"},e.createElement("use",{fill:"black",fillOpacity:"1",filter:"url(#filter-2)",xlinkHref:"#path-1"}),e.createElement("circle",{stroke:t?"#B11A00":"#FF6044",strokeWidth:"1",strokeLinejoin:"square",fill:t?"#B11A00":"#FFFFFF",fillRule:"evenodd",cx:"7",cy:"7",r:"6.5"})),e.createElement("polygon",{id:"+-copy",fill:t?"#FFFFFF":"#B11A00",points:"6.24723247 6.24723247 6.24723247 3 7.75276753 3 7.75276753 6.24723247 11 6.24723247 11 7.75276753 7.75276753 7.75276753 7.75276753 11 6.24723247 11 6.24723247 7.75276753 3 7.75276753 3 6.24723247"})))},Ve=function(n){var a=t(!1),i=I(a,2),l=i[0],c=i[1],u=t(0),s=I(u,2),p=s[0],d=s[1],f=r(null);o((function(){d(f.current?f.current.offsetHeight:0)}),[]);var m={"aria-label":qe,viewBox:"0 0 18 18",className:"conditionalIcon",onMouseEnter:function(){return c(!0)},onMouseLeave:function(){return c(!1)},onClick:n.toggleConditional},h={ref:f,currentHover:l,className:"variableTooltip",style:{marginTop:"-".concat(p+10,"px")},caretTop:p-2,caretLeft:2};return e.createElement(ke.Consumer,null,(function(t){return e.createElement(e.Fragment,null,e.createElement(ie,D({contentEditable:!1},h),'Show text: "',n.whenTrue,'"'),e.createElement(ae,D({contentEditable:!1,currentHover:t},m),Ge(l)))}))};Ve.propTypes={whenTrue:i.string,toggleConditional:i.func};var Ze=function(t){var n,r={className:"variableTooltip",currentHover:t.currentHover,caretTop:21,caretLeft:2,tooltipHeight:1.85},o=Se(t.whenTrue).length,a=Se(t.whenFalse).length,i=t.isTrue?Se(t.whenFalse):Se(t.whenTrue);return e.createElement(e.Fragment,null,e.createElement(ie,D({contentEditable:!1},r),(n=i,o&&a?'Change to: "'.concat(n,'"'):t.isContentShowing?"Hide text":'Change to: "'.concat(n,'"'))))};function Je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Ze.propTypes={currentHover:i.bool,isContentShowing:i.bool,whenTrue:i.string,whenFalse:i.string,isTrue:i.bool};var Ke=e.forwardRef((function(n,r){var o=n.attributes,a=n.children,i=n.children.props.node,p=n.children.props.node.data,d=c(),f=t(!1),m=I(f,2),h=m[0],v=m[1],g=l.findPath(d,i),y=!n.readOnly,b=p.isTrue?!!Se(p.whenTrue).length:!!Se(p.whenFalse).length,x=function(e){var t={object:"inline",type:"conditional",data:{name:p.name,whenTrue:p.whenTrue,whenFalse:p.whenFalse,isTrue:!p.isTrue},children:p.isTrue?p.whenFalse:p.whenTrue};u.withoutNormalizing(d,(function(){s.removeNodes(d,{at:e}),s.insertNodes(d,t,{at:e})}))},E=$e($e({id:p.name,className:b?"conditional":"",onMouseEnter:function(){return v(!0)},onMouseLeave:function(){return v(!1)},onClick:function(){return x(g)}},o),{},{ref:r}),C=$e({currentHover:h,isContentShowing:b},p),w={currentHover:h,whenTrue:Se(p.whenTrue),toggleConditional:function(){return x(g)}};return e.createElement("span",o,y&&(b?e.createElement(Ze,C):e.createElement(Ve,w)),e.createElement("span",E,a))}));Ke.displayName="Conditional",Ke.propTypes={attributes:i.PropTypes.shape({"data-key":i.string}),children:i.object.isRequired,editor:i.any,node:i.shape({data:i.obj}),readOnly:i.bool};var Ye=function(n){var a=t(!1),i=I(a,2),l=i[0],c=i[1],u=t(0),s=I(u,2),p=s[0],d=s[1],f=r(null);o((function(){d(f.current?f.current.offsetHeight:0)}),[]);var m={"aria-label":qe,viewBox:"0 0 18 18",className:"optionalIcon",onMouseEnter:function(){return c(!0)},onMouseLeave:function(){return c(!1)},onClick:n.toggleOptional},h={ref:f,currentHover:l,className:"optionalTooltip",style:{marginTop:"-".concat(p+10,"px")},caretTop:p-2,caretLeft:2};return e.createElement(ke.Consumer,null,(function(t){return e.createElement(e.Fragment,null,e.createElement(ce,D({contentEditable:!1},h),'Show text: "',n.whenSome,'"'),e.createElement(le,D({contentEditable:!1,currentHover:t},m),Ge(l)))}))};Ye.propTypes={whenSome:i.string,toggleOptional:i.func};var Qe=function(t){var n={className:"optionalTooltip",currentHover:t.currentHover,caretTop:21,caretLeft:2,tooltipHeight:1.85},r=t.hasSome?t.hasNone:t.hasSome,o=t.isContentShowing?"Hide text":'Change to: "'.concat(r,'"');return e.createElement(e.Fragment,null,e.createElement(ce,D({contentEditable:!1},n),o))};function Xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function tt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return nt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw a}}}}function nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Qe.propTypes={currentHover:i.bool,isContentShowing:i.bool,whenTrue:i.string,hasNone:i.string,hasSome:i.bool};var rt,ot=e.forwardRef((function(n,r){var o=n.attributes,a=n.children,i=n.children.props.node,d=n.children.props.node.data,f=c(),m=t(!1),h=I(m,2),v=h[0],g=h[1],y=l.findPath(f,i),b=!n.readOnly,x=!!p.string(i).length,E={object:"inline",type:"optional",data:{name:d.name,whenSome:d.whenSome,whenNone:d.whenNone,hasSome:!d.hasSome},children:d.hasSome?d.whenNone:d.whenSome},C=function(e,t){t&&function(e){var t,n=l.toSlateNode(f,e),r=l.findPath(f,n),o=tt(p.ancestors(f,r,{reverse:!0}));try{for(o.s();!(t=o.n()).done;){if(I(t.value,1)[0].type===_e)return!0}}catch(e){o.e(e)}finally{o.f()}return!1}(t)||function(e){u.withoutNormalizing(f,(function(){s.removeNodes(f,{at:e}),s.insertNodes(f,E,{at:e})}))}(e)},w=et(et({id:d.name,className:x?"optional":"",onMouseEnter:function(e){return"optional"===(t=e.target).className&&g(!0),void(t.className===_e&&g(!1));var t},onMouseLeave:function(){return g(!1)},onClick:function(e){return C(y,e.target)}},o),{},{ref:r}),O=et({currentHover:v,isContentShowing:x},d),F={currentHover:v,whenSome:p.string(E),toggleOptional:function(){return C(y)}};return e.createElement("span",o,b&&(x?e.createElement(Qe,O):e.createElement(Ye,F)),e.createElement("span",w,a))}));function at(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function it(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?at(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}ot.displayName="Optional",ot.propTypes={attributes:i.PropTypes.shape({"data-key":i.string}),children:i.object.isRequired,editor:i.any,node:i.shape({data:i.obj}),readOnly:i.bool};var lt=h.span(rt||(rt=A(["\n  z-index: 2;\n  visibility: ",";\n  transform: translateY(-110%);\n  white-space: normal;\n\n  &:before {\n    content: '';\n    position: absolute;\n    bottom: -6.7px;\n    left: 1px;\n    border-top: 6px solid #141F3C;\n    border-left: 6px solid transparent;\n    border-right: 6px solid transparent;\n  }\n\n  &:after {\n    content: '';\n    position: absolute;\n    bottom: -6.7px;\n    left: 2px;\n    border-top: 4px solid #141F3C;\n    border-left: 4px solid transparent;\n    border-right: 4px solid transparent;\n  }\n"])),(function(e){return e.currentHover?"visible":"hidden"})),ct=e.forwardRef((function(n,r){var o=n.attributes,a=n.children,i=n.children.props.node,l=n.children.props.node.data,c=n.setFormulaNode,u=n.setHoveringFormulaContract,s=t(!1),p=I(s,2),d=p[0],f=p[1],m=it({onMouseEnter:function(){return f(!0),u(!0),void c(i)},onMouseLeave:function(){return f(!1),u(!1),void c({})}},o),h=it({id:l.name,className:"formula",ref:r},o),v={className:"variableTooltip",currentHover:d,contentEditable:!1};return e.createElement("span",m,e.createElement(lt,v,l.code),e.createElement("span",h,a))}));ct.displayName="Formula",ct.propTypes={attributes:i.PropTypes.shape({"data-key":i.string}),children:i.object.isRequired,setHoveringFormulaContract:i.func,setFormulaNode:i.func,editor:i.any,node:i.shape({data:i.obj}),readOnly:i.bool};var ut=function e(t,n){if(n(t))return t;if(t.children){var r=[];return t.children.forEach((function(t){var o=e(t,n);Array.isArray(o)?r=r.concat(o):r.push(o)})),r}return[]};M("a {\n    color: #0f52ba;\n}\n\n.parseError {\n    background-color: #e98181;\n}\n\n.variable,\n.conditional,\n.optional {\n    border-radius: 2px;\n    background-color: #fff;\n    color: #000;\n}\n\n.conditional,\n.optional {\n    border: #FFDDA0 1px solid;\n    margin-left: 2px;\n    padding: 1px 3px;\n}\n\n.optional > .variable {\n    cursor: text;\n    box-shadow: inset 0px 0px 0px 1px #A4BBE7;\n    padding: 0px 2px;\n    border: #A4BBE7 0px solid;\n}\n\n.variable {\n    border: #A4BBE7 1px solid;\n    padding: 0px 3px;\n    border-radius: 2px;\n    background-color: #fff;\n}\n\n.formula {   \n    color: #AE00BE\n}\n\n.optional:hover,\n.conditional:hover {\n    cursor: pointer;\n    background-color: #d4d8e1;\n}\n\n.conditionalTooltip,\n.optionalTooltip,\n.variableTooltip {\n    opacity: 1 !important;\n    border: 1px solid #141F3C;\n    border-radius: 2px;\n    z-index:100;\n    background-color: #141F3C;\n    transition-duration: 0.25s;\n    color: #FFFFFF;\n    padding: 1px 3px;\n    position: absolute;\n}\n\n.conditionalIcon,\n.optionalIcon {\n    position: absolute;\n    display: inline-block;\n    transition-duration: 0.2s;\n    margin-left: -5px;\n    margin-top: -8px;\n    width: 18px;\n    height: 18px;\n}\n\n.conditionalIcon:hover,\n.optionalIcon:hover,\n.listIcon:hover {\n    cursor: pointer;\n}\n\n.listIcon {\n    position: absolute;\n    display: inline-block;\n    transition-duration: 0.2s;\n    margin-left: -35px;\n    margin-top: 4px;\n    width: 18px;\n    height: 16px;\n}\n.addListIcon{\n    display: block;\n    margin-top: 23px;\n}");var st=function(e,t){var n=e.insertData,r=e.onChange,o=t.onClauseUpdated,a=t.pasteToContract;return e.getClauseWithPath=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.selection,n=u.nodes(e,{match:function(e){return e.type===Pe},at:t}),r=I(n,1),o=r[0];return o},e.isInsideClause=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.selection;return!!e.getClauseWithPath(t)},e.onChange=function(){if(r(),e.isInsideClause()){var t=e.getClauseWithPath(),n=I(t,2),a=n[0],i=n[1],l=u.nodes(e,{match:function(e){return e.type===_e}}),c=I(l,1)[0];if(c&&c[0].data&&c[0].data.name)for(var f=c[0].data.name,m=u.nodes(e,{match:function(e){return e.type===_e&&e.data.name===f},at:i}),h=m.next(),v=function(){var t=h.value;if(!d.equals(t[1],c[1])&&p.string(t[0])!==p.string(c[0])){var n=JSON.parse(JSON.stringify(c[0]));b.withoutSaving(e,(function(){u.withoutNormalizing(e,(function(){s.removeNodes(e,{at:t[1]}),s.insertNodes(e,n,{at:t[1]})}))}))}h=m.next()};!h.done;)v();o&&o(a).then((function(t){var n=t.node,r=t.operation,o=t.error;if("replace_node"===r)s.removeNodes(e,{at:i}),s.insertNodes(e,n,{at:i});else if("update_formulas"===r&&c&&c[0].data&&c[0].data.name)for(var a=c[0].data.name,l=u.nodes(e,{match:function(e){return"formula"===e.type&&e.data.dependencies.includes(a)},at:i}),d=l.next(),f=function(){var t=d.value,r=function(e,t){var n=ut(e,(function(e){return"formula"===e.type&&e.data.name===t.data.name}));return n&&n.length>0?n[0]:null}(n,t[0]);if(r){var o=p.string(t[0]);p.string(r)!==o&&b.withoutSaving(e,(function(){u.withoutNormalizing(e,(function(){s.removeNodes(e,{at:t[1]}),s.insertNodes(e,r,{at:t[1]})}))}))}d=l.next()};!d.done;)f();b.withoutSaving(e,(function(){s.setNodes(e,{error:!!o},{at:i})}))}))}},e.insertData=function(e){var t=e.getData("text/html");if(t)try{var r=[],i=new E,l=new x,c={object:"value",document:{object:"document",data:{},children:l.fromCiceroMark(i.toCiceroMark(t)).document.children.map((function(e){return e.type===Pe&&(e.data.clauseid=y(),r.push(e)),e}))}};r.forEach((function(e){a(e.data.clauseid,e.data.src),o(e,!0)}));var u=i.toHtml(l.toCiceroMark(c));return void n({getData:function(t){return"text/html"===t?u:e.getData("text/plain")}})}catch(e){console.error(e)}n(e)},e.isClauseSupported=function(e){return function e(t,n){n.forEach((function(n){var r=n.type;switch(n.object){case"text":break;default:switch(r){case"ol_list":case"ul_list":if(n.data.kind===_e)throw new Error("List variable not supported");if(t.depth>0)throw new Error("Nested list not supported");t.depth+=1}}n.children&&e(t,n.children),"ol_list"!==r&&"ul_list"!==r||(t.depth-=1)}))}({depth:0},e.document?e.document.children:[e]),!0},e.canAddClause=function(){return!e.selection||e.selection.anchor.path.length<=2},e},pt=function(e){var t=e.insertText,n=e.isInline;return e.insertText=function(n){var r=u.next(e,{at:e.selection.focus.path}),o=p.parent(e,e.selection.focus.path),a=p.get(e,e.selection.focus.path).text.length,i=r?He(r[0]):null,l=o?He(o):null;r&&r[0].type===_e&&a===e.selection.focus.offset&&(s.select(e,r[1]),s.collapse(e,{edge:"start"})),p.parent(e,e.selection.focus.path).type!==_e||!1!==i&&void 0!==r||!1!==l?p.parent(e,e.selection.focus.path).type!==_e&&t(n):s.insertText(e,n)},e.isInline=function(e){return e.type===_e||n(e)},e},dt=function(e,t,n){if(!e||!t.isInsideClause())return!0;var r=t.selection,o=p.get(t,t.selection.focus.path).text.length,a=Me(t)&&!function(e){if(Me(e)){var t=p.parent(e,e.selection.focus.path);return He(t)}return!1}(t);if(a){if(function(e){return o===e.selection.focus.offset}(t)&&"deleteContentForward"===n.inputType)return!1;if("deleteContentBackward"===n.inputType)return r.anchor.offset>0;if("insertFromPaste"===n.inputType||"insertParagraph"===n.inputType||"insertLineBreak"===n.inputType)return!1}var i=u.next(t,{at:t.selection.focus.path});return i&&i[0].type===_e&&o===t.selection.focus.offset?"deleteContentBackward"!==n.inputType:a};function ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ht(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ht(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw a}}}}function ht(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var vt={value:{object:"value",document:{object:"document",data:{},nodes:[{object:"block",type:"paragraph",data:{},nodes:[{object:"text",text:"Welcome! Edit this text to get started.",marks:[]}]}]}},onChange:function(e){localStorage.setItem("contract-editor",e.toJSON())},plugins:[]},gt=function(n){var r=t(!1),o=I(r,2),i=o[0],c=o[1],d=t(null),h=I(d,2),v=h[0],g=h[1],y={onClauseUpdated:n.onClauseUpdated,pasteToContract:n.pasteToContract},b=a((function(e,t){var n,r=!1;if(!i||!v)return r;var o,a=l.findPath(e,v),c=l.findPath(e,t),u=mt(p.ancestors(e,a,{reverse:!0}));try{for(u.s();!(o=u.n()).done;){var s=I(o.value,1)[0];s.type===Pe&&(n=s.data.name)}}catch(e){u.e(e)}finally{u.f()}var d,f=mt(p.ancestors(e,c,{reverse:!0}));try{for(f.s();!(d=f.n()).done;){var m=I(d.value,1)[0];m.type===Pe&&m.data.name===n&&v.data.dependencies.includes(t.data.name)&&(r=!0)}}catch(e){f.e(e)}finally{f.f()}return r}),[i,v]);return e.createElement(m,{augmentEditor:function(e){return n.augmentEditor?n.augmentEditor(pt(st(Ae(e),y))):pt(st(Ae(e),y))},isEditable:function(e,t){if(e.isInsideClause()){var r=e.getClauseWithPath();if(!1===I(r,1)[0].data.parseable)return!0}return function(e,t){if("deleteContentForward"===t.inputType&&p.get(e,e.selection.focus.path).text.length===e.selection.focus.offset){var n=u.nodes(e,{at:u.next(e)[1],match:function(e){return e.type===Pe}});return!I(n,1)[0]}return!0}(e,t)&&dt(n.lockText,e,t)},value:n.value||vt.value,onChange:n.onChange||vt.onChange,customElements:function(t,r,o,a){var l,u={templateUri:o.data&&o.data.src?o.data.src:"",name:o.data&&o.data.name?o.data.name:"",error:o.error,clauseProps:n.clauseProps,readOnly:n.readOnly,hoveringFormulaContract:i,attributes:t,editor:a},s=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ft(Object(n),!0).forEach((function(t){N(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ft(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({element:o,editor:a,isFormulaDependency:b},t),p={readOnly:n.readOnly,attributes:t},d={name:o.data&&o.data.name?o.data.name:"",className:"formula",setHoveringFormulaContract:c,setFormulaNode:g,attributes:t,editor:a},f={readOnly:n.readOnly,attributes:t};return N(l={},Pe,(function(){return e.createElement(Ne,u,r)})),N(l,_e,(function(){return e.createElement(We,s,r)})),N(l,"conditional",(function(){return e.createElement(Ke,p,r)})),N(l,"formula",(function(){return e.createElement(ct,d,r)})),N(l,"optional",(function(){return e.createElement(ot,f,r)})),l},lockText:n.lockText,readOnly:n.readOnly,canBeFormatted:function(e){return!n.lockText||!e.isInsideClause()},canCopy:function(e){return!(e.isInsideClause(e.selection.anchor)||e.isInsideClause(e.selection.focus))},canKeyDown:function(e,t){if(8===(t.keyCode||t.charCode)&&f.equals(u.start(e,e.selection.anchor.path),e.selection.anchor)){var n=u.nodes(e,{at:u.previous(e)[1],match:function(e){return e.type===Pe}});return!I(n,1)[0]}return!0},onDragStart:function(e,t){t.stopPropagation();var n=l.toSlateNode(e,t.target),r=l.findPath(e,n),o=u.range(e,r);t.dataTransfer.setData("text",JSON.stringify(o))},onDragOver:function(e,t){t.stopPropagation(),t.dataTransfer.dropEffect="move"},onDrop:function(e,t){t.preventDefault();var n=l.findEventRange(e,t),r=u.nodes(e,{match:function(e){return e.type===Pe},at:n});if(I(r,1)[0])return!1;var o=JSON.parse(t.dataTransfer.getData("text")),a=e.getClauseWithPath(o);if(!a)return!0;var i=l.toSlateNode(e,t.target),c=l.findPath(e,i),d=k(p.ancestors(e,c,{reverse:!1})),f=d.length>1?d[1][0].type:null;if("ul_list"===f||"ol_list"===f){var m=d[1][0],h=l.findPath(e,m);d[1][0].children.length/2>d[2][1][1]?a[1]>h[0]?s.moveNodes(e,{at:a[1],to:h}):s.moveNodes(e,{at:a[1],to:[h[0]-1]}):a[1]>h[0]?s.moveNodes(e,{at:a[1],to:[h[0]+1]}):s.moveNodes(e,{at:a[1],to:h})}else{var v=d[1],g=v?v[1]:c;g.length?s.select(e,g):s.select(e,n);var y="end";if(g===c||0===c[1]&&c[0]===g[0]){var b=p.get(e,n.focus.path).text.length/2;n.focus.offset<b&&(y="start")}else{var x=k(p.children(e,g)).length/2;c[1]<x&&(y="start")}s.collapse(e,{edge:y}),s.removeNodes(e,{at:o.anchor.path,match:function(e){return e.type===Pe}}),s.insertNodes(e,a[0])}return!1},activeButton:n.activeButton,"data-testid":"editor"})};gt.propTypes={activeButton:i.object,augmentEditor:i.func,value:i.array,onChange:i.func,lockText:i.bool,readOnly:i.bool,pasteToContract:i.func,clauseMap:i.object,clauseProps:i.shape({CLAUSE_DELETE_FUNCTION:i.func,CLAUSE_EDIT_FUNCTION:i.func,CLAUSE_TEST_FUNCTION:i.func}),onClauseUpdated:i.func,onUndoOrRedo:i.func,plugins:i.arrayOf(i.shape({onEnter:i.func,onKeyDown:i.func,name:i.string.isRequired,augmentSchema:i.func}))};export default gt;export{ut as getChildren};
//# sourceMappingURL=index.esm.js.map
